{% extends "base.html" %}

{% block title %}Hero幻灯片管理 - 博文教育管理后台{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- 页面标题 -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0">
            <i class="bi bi-images me-2"></i>
            Hero幻灯片管理
        </h1>
        <a href="/admin/heroes/new" class="btn btn-primary">
            <i class="bi bi-plus-lg me-1"></i>
            新建幻灯片
        </a>
    </div>

    <p class="text-muted mb-4">管理首页Hero轮播幻灯片，支持排序和启用/禁用</p>

    <!-- 统计卡片 -->
    <div class="row g-3 mb-4">
        <div class="col-md-4">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="text-muted mb-1">总幻灯片数</h6>
                            <h3 class="mb-0">{{ total_heroes }}</h3>
                        </div>
                        <div class="fs-1 text-primary opacity-25">
                            <i class="bi bi-images"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="text-muted mb-1">已启用</h6>
                            <h3 class="mb-0 text-success">{{ active_heroes }}</h3>
                        </div>
                        <div class="fs-1 text-success opacity-25">
                            <i class="bi bi-check-circle"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="text-muted mb-1">已禁用</h6>
                            <h3 class="mb-0 text-warning">{{ inactive_heroes }}</h3>
                        </div>
                        <div class="fs-1 text-warning opacity-25">
                            <i class="bi bi-x-circle"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero列表 -->
    {% if heroes %}
    <div class="card border-0 shadow-sm">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th style="width: 60px;">排序</th>
                        <th style="width: 100px;">预览</th>
                        <th>标题</th>
                        <th style="width: 150px;">按钮配置</th>
                        <th style="width: 100px;">状态</th>
                        <th style="width: 200px;">操作</th>
                    </tr>
                </thead>
                <tbody>
                    {% for hero in heroes %}
                    <tr>
                        <td class="align-middle">
                            <span class="badge bg-secondary">{{ hero.sort_order }}</span>
                        </td>
                        <td class="align-middle">
                            <div style="width: 80px; height: 50px; overflow: hidden; border-radius: 4px;">
                                <img src="{{ hero.background_image }}"
                                     alt="{{ hero.title }}"
                                     class="w-100 h-100 object-fit-cover"
                                     onerror="this.src='/static/images/placeholder.png'">
                            </div>
                        </td>
                        <td class="align-middle">
                            <div>
                                <strong>{{ hero.title }}</strong>
                                {% if hero.title_en %}
                                <br><small class="text-muted">{{ hero.title_en }}</small>
                                {% endif %}
                            </div>
                            {% if hero.badge_text %}
                            <span class="badge bg-info mt-1">{{ hero.badge_text }}</span>
                            {% endif %}
                        </td>
                        <td class="align-middle">
                            {% if hero.button_text %}
                            <div class="small">
                                <i class="bi bi-link-45deg"></i> {{ hero.button_text }}
                            </div>
                            {% endif %}
                            {% if hero.button2_text %}
                            <div class="small text-muted">
                                <i class="bi bi-link-45deg"></i> {{ hero.button2_text }}
                            </div>
                            {% endif %}
                        </td>
                        <td class="align-middle">
                            {% if hero.is_active %}
                            <span class="badge bg-success">已启用</span>
                            {% else %}
                            <span class="badge bg-secondary">已禁用</span>
                            {% endif %}
                        </td>
                        <td class="align-middle">
                            <div class="btn-group btn-group-sm" role="group">
                                <a href="/admin/heroes/{{ hero.id }}/edit"
                                   class="btn btn-outline-primary"
                                   title="编辑">
                                    <i class="bi bi-pencil"></i>
                                </a>
                                <form action="/admin/heroes/{{ hero.id }}/toggle-status"
                                      method="post"
                                      class="d-inline">
                                    <button type="submit"
                                            class="btn btn-outline-{% if hero.is_active %}warning{% else %}success{% endif %}"
                                            title="{% if hero.is_active %}禁用{% else %}启用{% endif %}">
                                        <i class="bi bi-{% if hero.is_active %}eye-slash{% else %}eye{% endif %}"></i>
                                    </button>
                                </form>
                                <form action="/admin/heroes/{{ hero.id }}/delete"
                                      method="post"
                                      class="d-inline"
                                      onsubmit="return confirm('确定要删除这个Hero幻灯片吗？');">
                                    <button type="submit"
                                            class="btn btn-outline-danger"
                                            title="删除">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <div class="card border-0 shadow-sm">
        <div class="card-body text-center py-5">
            <i class="bi bi-images text-muted" style="font-size: 4rem;"></i>
            <h5 class="mt-3 text-muted">暂无Hero幻灯片</h5>
            <p class="text-muted">点击右上角的"新建幻灯片"按钮创建第一个Hero幻灯片</p>
            <a href="/admin/heroes/new" class="btn btn-primary mt-3">
                <i class="bi bi-plus-lg me-1"></i>
                新建幻灯片
            </a>
        </div>
    </div>
    {% endif %}

    <!-- 使用说明 -->
    <div class="alert alert-info mt-4" role="alert">
        <h6 class="alert-heading">
            <i class="bi bi-info-circle me-2"></i>
            使用说明
        </h6>
        <ul class="mb-0 small">
            <li><strong>排序顺序：</strong>数字越小越靠前，建议使用10、20、30...便于后续插入</li>
            <li><strong>背景图片：</strong>建议尺寸 1920x1080px，格式 JPG/PNG</li>
            <li><strong>启用状态：</strong>只有启用的幻灯片才会在前台显示</li>
            <li><strong>双语支持：</strong>英文字段为空时，前台会自动使用中文内容</li>
        </ul>
    </div>
</div>
{% endblock %}
