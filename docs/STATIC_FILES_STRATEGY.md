# é™æ€æ–‡ä»¶å¤„ç†ç­–ç•¥

## ğŸ“‹ å½“å‰æ¶æ„

### 1. é™æ€æ–‡ä»¶åˆ†ç¦»

é¡¹ç›®é‡‡ç”¨**å‰åå°é™æ€æ–‡ä»¶åˆ†ç¦»**çš„æ¶æ„ï¼š

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ templates/static/        # å‰å°é™æ€æ–‡ä»¶ (11MB)
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â””â”€â”€ images/
â””â”€â”€ admin/admin-static/      # ç®¡ç†åå°é™æ€æ–‡ä»¶ (96KB)
    â”œâ”€â”€ css/
    â”œâ”€â”€ js/
    â””â”€â”€ images/
```

### 2. FastAPI é™æ€æ–‡ä»¶æŒ‚è½½

åœ¨ `app/main.py` ä¸­é…ç½®ï¼š

```python
# å‰å°é™æ€æ–‡ä»¶ (ç”¨äºå‰å°ç½‘ç«™)
app.mount(
    "/static",
    StaticFiles(directory="templates/static"),
    name="static"
)

# ç®¡ç†åå°é™æ€æ–‡ä»¶ (ä»…ç”¨äºç®¡ç†åå°)
app.mount(
    "/admin-static",
    StaticFiles(directory="admin/admin-static"),
    name="admin-static"
)
```

### 3. ä½¿ç”¨åœºæ™¯

| è·¯å¾„ | ç”¨é€” | æœåŠ¡å¯¹è±¡ | å¤§å° |
|------|------|---------|------|
| `/static/` | å‰å°ç½‘ç«™èµ„æº | è®¿å®¢ã€ç”¨æˆ· | 11MB |
| `/admin-static/` | ç®¡ç†åå°èµ„æº | ç®¡ç†å‘˜ | 96KB |

## ğŸ¯ é™æ€é¡µé¢ç”Ÿæˆç­–ç•¥

### å½“å‰å®ç°

é™æ€é¡µé¢ç”Ÿæˆæ—¶**åªåŒ…å«å‰å°é™æ€æ–‡ä»¶**ï¼š

```bash
public/
â”œâ”€â”€ static -> ../templates/static  # ç¬¦å·é“¾æ¥
â”œâ”€â”€ zh/                            # ä¸­æ–‡é¡µé¢
â””â”€â”€ en/                            # è‹±æ–‡é¡µé¢
```

### ä¸ºä»€ä¹ˆä¸åŒ…å« admin-staticï¼Ÿ

âœ… **æ­£ç¡®çš„è®¾è®¡** - åŸå› å¦‚ä¸‹ï¼š

1. **è®¿é—®æƒé™åˆ†ç¦»**
   - å‰å°é¡µé¢ï¼šå…¬å¼€è®¿é—®ï¼Œä»»ä½•äººéƒ½å¯ä»¥è®¿é—®
   - ç®¡ç†åå°ï¼šéœ€è¦ç™»å½•è®¤è¯ï¼Œä»…ç®¡ç†å‘˜è®¿é—®

2. **éƒ¨ç½²åœºæ™¯ä¸åŒ**
   - å‰å°ï¼šå¯ä»¥éƒ¨ç½²ä¸ºçº¯é™æ€ç«™ç‚¹ï¼ˆCDNã€é™æ€æ‰˜ç®¡ï¼‰
   - ç®¡ç†åå°ï¼šå¿…é¡»è¿è¡Œ FastAPI åŠ¨æ€æœåŠ¡å™¨

3. **å®‰å…¨æ€§è€ƒè™‘**
   - ç®¡ç†åå°èµ„æºä¸åº”è¯¥åœ¨é™æ€ç«™ç‚¹ä¸­æš´éœ²
   - é¿å…æ³„éœ²ç®¡ç†åå°çš„ç»“æ„å’ŒåŠŸèƒ½

4. **èµ„æºç‹¬ç«‹æ€§**
   - å‰å°é¡µé¢ä¸å¼•ç”¨ä»»ä½• `/admin-static/` èµ„æº
   - éªŒè¯ç»“æœï¼š`grep -r "admin-static" public/` è¿”å›ç©º

## ğŸ“¦ éƒ¨ç½²æ–¹æ¡ˆ

### æ–¹æ¡ˆ A: åˆ†ç¦»éƒ¨ç½²ï¼ˆæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**: é«˜æµé‡ç½‘ç«™ã€éœ€è¦ CDN åŠ é€Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CDN / é™æ€æ‰˜ç®¡      â”‚
â”‚  - public/zh/       â”‚
â”‚  - public/en/       â”‚  â† çº¯é™æ€ï¼Œå…¨çƒåŠ é€Ÿ
â”‚  - public/static/   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPI æœåŠ¡å™¨      â”‚
â”‚  - /admin/*         â”‚  â† åŠ¨æ€è¿è¡Œï¼Œå¸¦è®¤è¯
â”‚  - /admin-static/*  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜ç‚¹**:
- âœ… å‰å°æé€Ÿè®¿é—®ï¼ˆCDNï¼‰
- âœ… ç®¡ç†åå°å®‰å…¨éš”ç¦»
- âœ… èŠ‚çœæœåŠ¡å™¨å¸¦å®½
- âœ… é™ä½æœåŠ¡å™¨è´Ÿè½½

**éƒ¨ç½²æ­¥éª¤**:

1. **éƒ¨ç½²é™æ€å‰å°åˆ° CDN**:
```bash
# 1. ç”Ÿæˆé™æ€é¡µé¢
python scripts/generate_static.py -o public

# 2. å¤åˆ¶é™æ€èµ„æº
cp -r templates/static public/

# 3. ä¸Šä¼ åˆ° CDNï¼ˆç¤ºä¾‹ï¼šAWS S3 + CloudFrontï¼‰
aws s3 sync public/ s3://your-bucket/
```

2. **éƒ¨ç½²åŠ¨æ€åå°åˆ°æœåŠ¡å™¨**:
```bash
# åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ FastAPI
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

3. **é…ç½®åŸŸå**:
```
å‰å°ç½‘ç«™: https://www.boweneducation.co.uk  â†’ CDN
ç®¡ç†åå°: https://admin.boweneducation.co.uk â†’ FastAPI æœåŠ¡å™¨
```

---

### æ–¹æ¡ˆ B: æ··åˆéƒ¨ç½²

**é€‚ç”¨åœºæ™¯**: ä¸­å°å‹ç½‘ç«™ã€å•æœåŠ¡å™¨éƒ¨ç½²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nginx (å‰ç«¯ä»£ç†)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  /          â†’ public/       â”‚  â† é™æ€æ–‡ä»¶
â”‚  /static/   â†’ public/static/â”‚  â† é™æ€èµ„æº
â”‚  /admin/*   â†’ FastAPI:8000  â”‚  â† åŠ¨æ€åå°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Nginx é…ç½®ç¤ºä¾‹**:

```nginx
server {
    listen 80;
    server_name boweneducation.co.uk;

    # é™æ€å‰å°é¡µé¢
    location / {
        root /var/www/public;
        try_files $uri $uri/ =404;
    }

    # é™æ€èµ„æºï¼ˆå‰å°ï¼‰
    location /static/ {
        root /var/www/public;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # ç®¡ç†åå°ï¼ˆåŠ¨æ€ï¼‰
    location /admin {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # ç®¡ç†åå°é™æ€æ–‡ä»¶
    location /admin-static/ {
        proxy_pass http://127.0.0.1:8000;
    }
}
```

**ä¼˜ç‚¹**:
- âœ… å•åŸŸåè®¿é—®
- âœ… ç®€åŒ–éƒ¨ç½²
- âœ… é€‚åˆå°å‹é¡¹ç›®

**ç¼ºç‚¹**:
- âš ï¸ éœ€è¦æœåŠ¡å™¨æŒç»­è¿è¡Œ
- âš ï¸ æ— æ³•ä½¿ç”¨ CDN åŠ é€Ÿå‰å°

---

### æ–¹æ¡ˆ C: å®Œå…¨åŠ¨æ€ï¼ˆä¸æ¨èï¼‰

**é€‚ç”¨åœºæ™¯**: å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒ

ç›´æ¥è¿è¡Œ FastAPIï¼Œæ‰€æœ‰è¯·æ±‚éƒ½èµ°åŠ¨æ€è·¯ç”±ï¼š

```bash
uvicorn app.main:app --reload
```

**ç¼ºç‚¹**:
- âŒ æ€§èƒ½å·®ï¼ˆæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦æ¸²æŸ“ï¼‰
- âŒ æœåŠ¡å™¨è´Ÿè½½é«˜
- âŒ ä¸é€‚åˆç”Ÿäº§ç¯å¢ƒ

## ğŸ”§ é™æ€èµ„æºå¤„ç†æœ€ä½³å®è·µ

### 1. ç¬¦å·é“¾æ¥ vs å¤åˆ¶

**å¼€å‘/æµ‹è¯•ç¯å¢ƒ**ï¼ˆå½“å‰ä½¿ç”¨ï¼‰:
```bash
# ä½¿ç”¨ç¬¦å·é“¾æ¥ï¼ˆèŠ‚çœç©ºé—´ï¼Œå®æ—¶åŒæ­¥ï¼‰
ln -s ../templates/static public/static
```

**ç”Ÿäº§ç¯å¢ƒ**ï¼ˆæ¨èï¼‰:
```bash
# å¤åˆ¶æ–‡ä»¶ï¼ˆç‹¬ç«‹éƒ¨ç½²ï¼Œä¸ä¾èµ–æºç ï¼‰
cp -r templates/static public/static
```

### 2. èµ„æºä¼˜åŒ–

åœ¨éƒ¨ç½²åˆ°ç”Ÿäº§å‰ï¼Œå»ºè®®ä¼˜åŒ–é™æ€èµ„æºï¼š

```bash
# å‹ç¼© CSS
npx csso public/static/css/main.css -o public/static/css/main.min.css

# å‹ç¼© JS
npx terser public/static/js/main.js -o public/static/js/main.min.js

# ä¼˜åŒ–å›¾ç‰‡
find public/static/images -name "*.jpg" -exec jpegoptim --max=85 {} \;
find public/static/images -name "*.png" -exec optipng -o7 {} \;
```

### 3. ç¼“å­˜ç­–ç•¥

**CDN / Nginx ç¼“å­˜é…ç½®**:

```nginx
# é™æ€èµ„æº - é•¿æœŸç¼“å­˜
location ~* \.(jpg|jpeg|png|gif|ico|css|js|woff|woff2|ttf)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

# HTML é¡µé¢ - çŸ­æœŸç¼“å­˜æˆ–ä¸ç¼“å­˜
location ~* \.html$ {
    expires 1h;
    add_header Cache-Control "public, must-revalidate";
}
```

## ğŸ“Š èµ„æºå¤§å°å¯¹æ¯”

| ç±»å‹ | è·¯å¾„ | å¤§å° | åŒ…å«åœ¨é™æ€éƒ¨ç½² |
|------|------|------|---------------|
| å‰å°é™æ€èµ„æº | `templates/static/` | 11MB | âœ… æ˜¯ |
| ç®¡ç†åå°é™æ€èµ„æº | `admin/admin-static/` | 96KB | âŒ å¦ |
| é™æ€ HTML é¡µé¢ | `public/zh/` + `public/en/` | ~11MB | âœ… æ˜¯ |
| **æ€»è®¡ï¼ˆé™æ€éƒ¨ç½²ï¼‰** | | **~22MB** | |

## âœ… æ€»ç»“

### å½“å‰å®ç°ï¼ˆæ­£ç¡®ï¼‰

âœ… **é™æ€é¡µé¢ç”ŸæˆåªåŒ…å«å‰å°èµ„æº**
- ç¬¦åˆå‰åå°åˆ†ç¦»åŸåˆ™
- å®‰å…¨æ€§å¥½
- ä¾¿äºåˆ†ç¦»éƒ¨ç½²

### æ¨èéƒ¨ç½²æ–¹æ¡ˆ

**å°å‹é¡¹ç›®**: æ–¹æ¡ˆ Bï¼ˆæ··åˆéƒ¨ç½²ï¼‰
**ä¸­å¤§å‹é¡¹ç›®**: æ–¹æ¡ˆ Aï¼ˆåˆ†ç¦»éƒ¨ç½² + CDNï¼‰

### ä¸éœ€è¦ä¿®æ”¹çš„åœ°æ–¹

âŒ ä¸è¦åœ¨é™æ€é¡µé¢ä¸­åŒ…å« `admin-static`
âŒ ä¸è¦åœ¨å‰å°é¡µé¢ä¸­å¼•ç”¨ç®¡ç†åå°èµ„æº
âŒ ä¸è¦å°†ç®¡ç†åå°æš´éœ²åœ¨å…¬å¼€çš„é™æ€ç«™ç‚¹ä¸Š

### åç»­ä¼˜åŒ–å»ºè®®

1. **æ·»åŠ æ„å»ºè„šæœ¬** - è‡ªåŠ¨åŒ–é™æ€èµ„æºä¼˜åŒ–å’Œéƒ¨ç½²
2. **é…ç½® CDN** - åŠ é€Ÿå…¨çƒè®¿é—®
3. **å¯ç”¨ HTTPS** - æå‡å®‰å…¨æ€§å’Œ SEO
4. **ç›‘æ§æ€§èƒ½** - ä½¿ç”¨ Google Analytics å’Œ PageSpeed Insights

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-11-18
**ç»´æŠ¤è€…**: Claude Code
