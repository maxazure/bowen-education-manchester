"""Add all 20 core modules: team, portfolio, faq, comment, user, newsletter, cart, order, booking, restaurant, event, gallery, video, file_download

Revision ID: 21fd3e69434b
Revises: 
Create Date: 2025-11-02 20:28:39.034502

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision: str = '21fd3e69434b'
down_revision: Union[str, None] = None
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('booking_service',
    sa.Column('name', sa.String(length=200), nullable=False, comment='服务名称'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='服务Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='服务描述'),
    sa.Column('duration_minutes', sa.Integer(), nullable=False, comment='服务时长(分钟)'),
    sa.Column('price', sa.Float(), nullable=True, comment='服务价格'),
    sa.Column('buffer_time_minutes', sa.Integer(), nullable=False, comment='缓冲时间(分钟,两次预约间隔)'),
    sa.Column('max_capacity', sa.Integer(), nullable=False, comment='最大容量(同时服务人数)'),
    sa.Column('allow_waitlist', sa.Boolean(), nullable=False, comment='是否允许候补名单'),
    sa.Column('min_advance_hours', sa.Integer(), nullable=False, comment='最少提前预约小时数'),
    sa.Column('max_advance_days', sa.Integer(), nullable=False, comment='最多提前预约天数'),
    sa.Column('allow_cancel_hours', sa.Integer(), nullable=False, comment='允许取消的最少提前小时数'),
    sa.Column('working_days', sa.String(length=100), nullable=True, comment='工作日(如:1,2,3,4,5表示周一到周五)'),
    sa.Column('working_start_time', sa.Time(), nullable=True, comment='工作开始时间'),
    sa.Column('working_end_time', sa.Time(), nullable=True, comment='工作结束时间'),
    sa.Column('is_active', sa.Boolean(), nullable=False, comment='是否启用'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('faq',
    sa.Column('category', sa.String(length=100), nullable=True, comment='问题分类'),
    sa.Column('question', sa.String(length=500), nullable=False, comment='问题'),
    sa.Column('answer', sa.Text(), nullable=False, comment='答案'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_visible', sa.Boolean(), nullable=False, comment='是否可见'),
    sa.Column('is_pinned', sa.Boolean(), nullable=False, comment='是否置顶'),
    sa.Column('view_count', sa.Integer(), nullable=False, comment='查看次数'),
    sa.Column('helpful_count', sa.Integer(), nullable=False, comment='有用次数'),
    sa.Column('unhelpful_count', sa.Integer(), nullable=False, comment='无用次数'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('faq_category',
    sa.Column('name', sa.String(length=100), nullable=False, comment='分类名称'),
    sa.Column('slug', sa.String(length=100), nullable=False, comment='分类Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='分类描述'),
    sa.Column('icon', sa.String(length=50), nullable=True, comment='图标标识'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_visible', sa.Boolean(), nullable=False, comment='是否可见'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('slug')
    )
    op.create_table('file_category',
    sa.Column('name', sa.String(length=100), nullable=False, comment='分类名称'),
    sa.Column('slug', sa.String(length=100), nullable=False, comment='分类Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='分类描述'),
    sa.Column('parent_id', sa.Integer(), nullable=True, comment='父分类ID'),
    sa.Column('icon_class', sa.String(length=50), nullable=True, comment='图标CSS类名'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_visible', sa.Boolean(), nullable=False, comment='是否可见'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['parent_id'], ['file_category.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('media_file',
    sa.Column('filename_original', sa.String(length=255), nullable=False, comment='原始文件名'),
    sa.Column('mime_type', sa.String(length=100), nullable=False, comment='MIME类型'),
    sa.Column('size_bytes', sa.Integer(), nullable=False, comment='文件大小（字节）'),
    sa.Column('width', sa.Integer(), nullable=True, comment='图片宽度'),
    sa.Column('height', sa.Integer(), nullable=True, comment='图片高度'),
    sa.Column('path_original', sa.String(length=500), nullable=False, comment='原图路径'),
    sa.Column('path_medium', sa.String(length=500), nullable=True, comment='中等尺寸图路径'),
    sa.Column('path_thumb', sa.String(length=500), nullable=True, comment='缩略图路径'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('newsletter_campaign',
    sa.Column('name', sa.String(length=200), nullable=False, comment='活动名称'),
    sa.Column('subject', sa.String(length=200), nullable=False, comment='邮件主题'),
    sa.Column('preview_text', sa.String(length=255), nullable=True, comment='预览文本'),
    sa.Column('content_html', sa.Text(), nullable=False, comment='邮件内容HTML'),
    sa.Column('content_text', sa.Text(), nullable=True, comment='纯文本内容'),
    sa.Column('status', sa.Enum('draft', 'scheduled', 'sending', 'sent', 'cancelled', name='campaign_status'), nullable=False, comment='活动状态'),
    sa.Column('scheduled_at', sa.DateTime(), nullable=True, comment='计划发送时间'),
    sa.Column('sent_at', sa.DateTime(), nullable=True, comment='实际发送时间'),
    sa.Column('target_groups', sa.String(length=255), nullable=True, comment='目标分组(逗号分隔)'),
    sa.Column('target_all', sa.Boolean(), nullable=False, comment='是否发送给所有订阅者'),
    sa.Column('total_recipients', sa.Integer(), nullable=False, comment='收件人总数'),
    sa.Column('total_sent', sa.Integer(), nullable=False, comment='成功发送数'),
    sa.Column('total_failed', sa.Integer(), nullable=False, comment='发送失败数'),
    sa.Column('total_opened', sa.Integer(), nullable=False, comment='打开数'),
    sa.Column('total_clicked', sa.Integer(), nullable=False, comment='点击数'),
    sa.Column('total_unsubscribed', sa.Integer(), nullable=False, comment='取消订阅数'),
    sa.Column('total_bounced', sa.Integer(), nullable=False, comment='退信数'),
    sa.Column('from_name', sa.String(length=100), nullable=True, comment='发件人名称'),
    sa.Column('from_email', sa.String(length=100), nullable=True, comment='发件人邮箱'),
    sa.Column('reply_to_email', sa.String(length=100), nullable=True, comment='回复邮箱'),
    sa.Column('notes', sa.Text(), nullable=True, comment='活动备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('newsletter_subscriber',
    sa.Column('email', sa.String(length=100), nullable=False, comment='订阅邮箱'),
    sa.Column('first_name', sa.String(length=50), nullable=True, comment='名字'),
    sa.Column('last_name', sa.String(length=50), nullable=True, comment='姓氏'),
    sa.Column('status', sa.Enum('pending', 'active', 'unsubscribed', 'bounced', name='subscriber_status'), nullable=False, comment='订阅状态'),
    sa.Column('is_verified', sa.Boolean(), nullable=False, comment='是否已验证'),
    sa.Column('subscription_source', sa.String(length=100), nullable=True, comment='订阅来源(页面/弹窗/活动等)'),
    sa.Column('subscription_ip', sa.String(length=50), nullable=True, comment='订阅时IP地址'),
    sa.Column('subscribed_at', sa.DateTime(), nullable=True, comment='订阅时间'),
    sa.Column('unsubscribed_at', sa.DateTime(), nullable=True, comment='取消订阅时间'),
    sa.Column('unsubscribe_reason', sa.Text(), nullable=True, comment='取消订阅原因'),
    sa.Column('group_tags', sa.String(length=255), nullable=True, comment='订阅分组标签(逗号分隔,如:vip,promotion)'),
    sa.Column('total_emails_sent', sa.Integer(), nullable=False, comment='已发送邮件总数'),
    sa.Column('total_emails_opened', sa.Integer(), nullable=False, comment='已打开邮件总数'),
    sa.Column('total_links_clicked', sa.Integer(), nullable=False, comment='已点击链接总数'),
    sa.Column('last_email_sent_at', sa.DateTime(), nullable=True, comment='最后发送邮件时间'),
    sa.Column('last_email_opened_at', sa.DateTime(), nullable=True, comment='最后打开邮件时间'),
    sa.Column('preferred_language', sa.String(length=10), nullable=True, comment='首选语言'),
    sa.Column('email_frequency', sa.Enum('daily', 'weekly', 'monthly', name='email_frequency'), nullable=False, comment='邮件频率'),
    sa.Column('notes', sa.Text(), nullable=True, comment='管理员备注'),
    sa.Column('bounce_count', sa.Integer(), nullable=False, comment='退信次数'),
    sa.Column('complaint_count', sa.Integer(), nullable=False, comment='投诉次数'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('email')
    )
    op.create_table('portfolio_category',
    sa.Column('name', sa.String(length=100), nullable=False, comment='分类名称'),
    sa.Column('slug', sa.String(length=100), nullable=False, comment='分类Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='分类描述'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_visible', sa.Boolean(), nullable=False, comment='是否可见'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('slug')
    )
    op.create_table('site_column',
    sa.Column('name', sa.String(length=100), nullable=False, comment='栏目名称'),
    sa.Column('slug', sa.String(length=100), nullable=False, comment='URL Slug'),
    sa.Column('column_type', sa.Enum('SINGLE_PAGE', 'POST', 'PRODUCT', 'CUSTOM', name='columntype'), nullable=False, comment='栏目类型'),
    sa.Column('parent_id', sa.Integer(), nullable=True, comment='父栏目ID'),
    sa.Column('icon', sa.String(length=50), nullable=True, comment='图标标识'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('show_in_nav', sa.Boolean(), nullable=False, comment='是否显示在导航'),
    sa.Column('is_enabled', sa.Boolean(), nullable=False, comment='是否启用'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['parent_id'], ['site_column.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('slug')
    )
    op.create_table('site_setting',
    sa.Column('setting_key', sa.String(length=100), nullable=False, comment='配置键'),
    sa.Column('value_text', sa.Text(), nullable=False, comment='配置值'),
    sa.Column('value_type', sa.Enum('string', 'html', 'json', 'media', name='setting_value_type'), nullable=False, comment='值类型'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('setting_key')
    )
    op.create_table('user',
    sa.Column('username', sa.String(length=100), nullable=False, comment='用户名'),
    sa.Column('email', sa.String(length=100), nullable=False, comment='邮箱'),
    sa.Column('phone', sa.String(length=50), nullable=True, comment='手机号码'),
    sa.Column('password_hash', sa.String(length=255), nullable=False, comment='密码哈希'),
    sa.Column('first_name', sa.String(length=50), nullable=True, comment='名字'),
    sa.Column('last_name', sa.String(length=50), nullable=True, comment='姓氏'),
    sa.Column('display_name', sa.String(length=100), nullable=True, comment='显示名称'),
    sa.Column('bio', sa.Text(), nullable=True, comment='个人简介'),
    sa.Column('avatar_url', sa.String(length=255), nullable=True, comment='头像URL'),
    sa.Column('date_of_birth', sa.DateTime(), nullable=True, comment='出生日期'),
    sa.Column('gender', sa.Enum('male', 'female', 'other', 'prefer_not_to_say', name='user_gender'), nullable=True, comment='性别'),
    sa.Column('address_line1', sa.String(length=255), nullable=True, comment='地址行1'),
    sa.Column('address_line2', sa.String(length=255), nullable=True, comment='地址行2'),
    sa.Column('city', sa.String(length=100), nullable=True, comment='城市'),
    sa.Column('state', sa.String(length=100), nullable=True, comment='州/省'),
    sa.Column('postal_code', sa.String(length=20), nullable=True, comment='邮编'),
    sa.Column('country', sa.String(length=100), nullable=True, comment='国家'),
    sa.Column('role', sa.Enum('admin', 'member', 'vip', 'guest', name='user_role'), nullable=False, comment='用户角色'),
    sa.Column('is_active', sa.Boolean(), nullable=False, comment='账户是否激活'),
    sa.Column('is_verified', sa.Boolean(), nullable=False, comment='邮箱是否已验证'),
    sa.Column('is_staff', sa.Boolean(), nullable=False, comment='是否为员工'),
    sa.Column('membership_level', sa.Enum('basic', 'silver', 'gold', 'platinum', name='membership_level'), nullable=False, comment='会员等级'),
    sa.Column('membership_expires_at', sa.DateTime(), nullable=True, comment='会员到期时间'),
    sa.Column('points', sa.Integer(), nullable=False, comment='用户积分'),
    sa.Column('total_earned_points', sa.Integer(), nullable=False, comment='累计获得积分'),
    sa.Column('last_login_at', sa.DateTime(), nullable=True, comment='最后登录时间'),
    sa.Column('last_login_ip', sa.String(length=50), nullable=True, comment='最后登录IP'),
    sa.Column('login_count', sa.Integer(), nullable=False, comment='登录次数'),
    sa.Column('failed_login_attempts', sa.Integer(), nullable=False, comment='失败登录次数'),
    sa.Column('locked_until', sa.DateTime(), nullable=True, comment='账户锁定至'),
    sa.Column('email_notifications', sa.Boolean(), nullable=False, comment='是否接收邮件通知'),
    sa.Column('sms_notifications', sa.Boolean(), nullable=False, comment='是否接收短信通知'),
    sa.Column('marketing_emails', sa.Boolean(), nullable=False, comment='是否接收营销邮件'),
    sa.Column('facebook_id', sa.String(length=100), nullable=True, comment='Facebook账号ID'),
    sa.Column('google_id', sa.String(length=100), nullable=True, comment='Google账号ID'),
    sa.Column('linkedin_id', sa.String(length=100), nullable=True, comment='LinkedIn账号ID'),
    sa.Column('notes', sa.Text(), nullable=True, comment='管理员备注'),
    sa.Column('email_verified_at', sa.DateTime(), nullable=True, comment='邮箱验证时间'),
    sa.Column('phone_verified_at', sa.DateTime(), nullable=True, comment='手机验证时间'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('email'),
    sa.UniqueConstraint('username')
    )
    op.create_table('video_category',
    sa.Column('name', sa.String(length=100), nullable=False, comment='分类名称'),
    sa.Column('slug', sa.String(length=100), nullable=False, comment='分类Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='分类描述'),
    sa.Column('parent_id', sa.Integer(), nullable=True, comment='父分类ID'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_visible', sa.Boolean(), nullable=False, comment='是否可见'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['parent_id'], ['video_category.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('comment',
    sa.Column('commentable_type', sa.String(length=50), nullable=False, comment='评论对象类型（post/product/portfolio等）'),
    sa.Column('commentable_id', sa.Integer(), nullable=False, comment='评论对象ID'),
    sa.Column('author_name', sa.String(length=100), nullable=False, comment='评论者姓名'),
    sa.Column('author_email', sa.String(length=100), nullable=False, comment='评论者邮箱'),
    sa.Column('author_website', sa.String(length=255), nullable=True, comment='评论者网站'),
    sa.Column('user_id', sa.Integer(), nullable=True, comment='关联用户ID（如已登录）'),
    sa.Column('content', sa.Text(), nullable=False, comment='评论内容'),
    sa.Column('rating', sa.Integer(), nullable=True, comment='评分（1-5星）'),
    sa.Column('parent_id', sa.Integer(), nullable=True, comment='父评论ID（用于回复）'),
    sa.Column('status', sa.Enum('pending', 'approved', 'spam', 'trash', name='comment_status'), nullable=False, comment='状态'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否精选'),
    sa.Column('admin_reply', sa.Text(), nullable=True, comment='管理员回复内容'),
    sa.Column('replied_at', sa.DateTime(), nullable=True, comment='回复时间'),
    sa.Column('helpful_count', sa.Integer(), nullable=False, comment='有用次数'),
    sa.Column('report_count', sa.Integer(), nullable=False, comment='举报次数'),
    sa.Column('ip_address', sa.String(length=45), nullable=True, comment='IP地址'),
    sa.Column('user_agent', sa.String(length=500), nullable=True, comment='用户代理'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['parent_id'], ['comment.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('custom_field_def',
    sa.Column('module_type', sa.Enum('PRODUCT', 'POST', 'CUSTOM', name='custom_field_module_type'), nullable=False, comment='模块类型'),
    sa.Column('column_id', sa.Integer(), nullable=True, comment='关联栏目ID（NULL表示全局）'),
    sa.Column('field_key', sa.String(length=100), nullable=False, comment='字段键名'),
    sa.Column('label', sa.String(length=100), nullable=False, comment='字段显示名'),
    sa.Column('input_type', sa.Enum('text', 'textarea', 'number', 'select', 'multiselect', 'radio', 'boolean', 'image', 'color', 'date', 'price', name='custom_field_input_type'), nullable=False, comment='输入类型'),
    sa.Column('required', sa.Boolean(), nullable=False, comment='是否必填'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('min_value', sa.Float(), nullable=True, comment='数字下限'),
    sa.Column('max_value', sa.Float(), nullable=True, comment='数字上限'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['column_id'], ['site_column.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('event',
    sa.Column('title', sa.String(length=200), nullable=False, comment='活动标题'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='活动Slug'),
    sa.Column('description', sa.Text(), nullable=False, comment='活动描述'),
    sa.Column('summary', sa.Text(), nullable=True, comment='活动简介'),
    sa.Column('event_type', sa.Enum('conference', 'workshop', 'seminar', 'training', 'webinar', 'social', 'other', name='event_type'), nullable=False, comment='活动类型'),
    sa.Column('start_datetime', sa.DateTime(), nullable=False, comment='开始时间'),
    sa.Column('end_datetime', sa.DateTime(), nullable=False, comment='结束时间'),
    sa.Column('timezone', sa.String(length=50), nullable=True, comment='时区'),
    sa.Column('registration_deadline', sa.DateTime(), nullable=True, comment='报名截止时间'),
    sa.Column('location_type', sa.Enum('physical', 'online', 'hybrid', name='event_location_type'), nullable=False, comment='活动形式'),
    sa.Column('venue_name', sa.String(length=200), nullable=True, comment='场地名称'),
    sa.Column('venue_address', sa.String(length=500), nullable=True, comment='场地地址'),
    sa.Column('venue_city', sa.String(length=100), nullable=True, comment='城市'),
    sa.Column('venue_postal_code', sa.String(length=20), nullable=True, comment='邮编'),
    sa.Column('online_meeting_url', sa.String(length=500), nullable=True, comment='在线会议链接'),
    sa.Column('online_meeting_password', sa.String(length=100), nullable=True, comment='会议密码'),
    sa.Column('max_attendees', sa.Integer(), nullable=True, comment='最大参会人数'),
    sa.Column('current_attendees', sa.Integer(), nullable=False, comment='当前报名人数'),
    sa.Column('allow_waitlist', sa.Boolean(), nullable=False, comment='是否允许候补'),
    sa.Column('waitlist_count', sa.Integer(), nullable=False, comment='候补人数'),
    sa.Column('is_free', sa.Boolean(), nullable=False, comment='是否免费'),
    sa.Column('ticket_price', sa.Float(), nullable=True, comment='票价'),
    sa.Column('early_bird_price', sa.Float(), nullable=True, comment='早鸟价'),
    sa.Column('early_bird_deadline', sa.DateTime(), nullable=True, comment='早鸟截止时间'),
    sa.Column('cover_media_id', sa.Integer(), nullable=True, comment='封面图ID'),
    sa.Column('status', sa.Enum('draft', 'published', 'cancelled', 'completed', name='event_status'), nullable=False, comment='活动状态'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('is_public', sa.Boolean(), nullable=False, comment='是否公开(私人活动需邀请)'),
    sa.Column('organizer_name', sa.String(length=200), nullable=True, comment='主办方名称'),
    sa.Column('organizer_email', sa.String(length=100), nullable=True, comment='主办方邮箱'),
    sa.Column('organizer_phone', sa.String(length=50), nullable=True, comment='主办方电话'),
    sa.Column('contact_person', sa.String(length=100), nullable=True, comment='联系人'),
    sa.Column('agenda', sa.Text(), nullable=True, comment='活动议程(JSON或HTML格式)'),
    sa.Column('speakers', sa.Text(), nullable=True, comment='演讲嘉宾(JSON格式)'),
    sa.Column('materials_url', sa.String(length=500), nullable=True, comment='活动资料链接'),
    sa.Column('seo_title', sa.String(length=200), nullable=True, comment='SEO标题'),
    sa.Column('seo_description', sa.Text(), nullable=True, comment='SEO描述'),
    sa.Column('tags', sa.String(length=255), nullable=True, comment='标签(逗号分隔)'),
    sa.Column('notes', sa.Text(), nullable=True, comment='内部备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['cover_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('file_download',
    sa.Column('title', sa.String(length=200), nullable=False, comment='文件标题'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='文件Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='文件描述'),
    sa.Column('category_id', sa.Integer(), nullable=True, comment='文件分类ID'),
    sa.Column('file_media_id', sa.Integer(), nullable=False, comment='文件ID'),
    sa.Column('file_name', sa.String(length=255), nullable=False, comment='文件名'),
    sa.Column('file_extension', sa.String(length=20), nullable=True, comment='文件扩展名'),
    sa.Column('file_size_kb', sa.Integer(), nullable=True, comment='文件大小(KB)'),
    sa.Column('file_type', sa.Enum('pdf', 'doc', 'xls', 'ppt', 'zip', 'image', 'video', 'other', name='file_download_type'), nullable=False, comment='文件类型'),
    sa.Column('version', sa.String(length=50), nullable=True, comment='文件版本号'),
    sa.Column('is_latest', sa.Boolean(), nullable=False, comment='是否为最新版本'),
    sa.Column('previous_version_id', sa.Integer(), nullable=True, comment='前一版本ID'),
    sa.Column('thumbnail_media_id', sa.Integer(), nullable=True, comment='缩略图ID'),
    sa.Column('access_level', sa.Enum('public', 'members_only', 'vip_only', 'admin_only', name='file_access_level'), nullable=False, comment='访问权限'),
    sa.Column('requires_login', sa.Boolean(), nullable=False, comment='是否需要登录下载'),
    sa.Column('allowed_roles', sa.String(length=255), nullable=True, comment='允许下载的角色(逗号分隔)'),
    sa.Column('download_limit_per_user', sa.Integer(), nullable=True, comment='每个用户下载次数限制(null表示不限)'),
    sa.Column('link_expiry_days', sa.Integer(), nullable=True, comment='下载链接有效期(天,null表示永久)'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('is_active', sa.Boolean(), nullable=False, comment='是否启用'),
    sa.Column('status', sa.Enum('draft', 'published', 'archived', name='file_status'), nullable=False, comment='文件状态'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('tags', sa.String(length=255), nullable=True, comment='标签(逗号分隔)'),
    sa.Column('download_count', sa.Integer(), nullable=False, comment='下载次数'),
    sa.Column('view_count', sa.Integer(), nullable=False, comment='查看次数'),
    sa.Column('last_downloaded_at', sa.DateTime(), nullable=True, comment='最后下载时间'),
    sa.Column('usage_instructions', sa.Text(), nullable=True, comment='使用说明'),
    sa.Column('system_requirements', sa.Text(), nullable=True, comment='系统要求'),
    sa.Column('release_notes', sa.Text(), nullable=True, comment='发布说明/更新日志'),
    sa.Column('seo_title', sa.String(length=200), nullable=True, comment='SEO标题'),
    sa.Column('seo_description', sa.Text(), nullable=True, comment='SEO描述'),
    sa.Column('author', sa.String(length=100), nullable=True, comment='作者'),
    sa.Column('published_date', sa.DateTime(), nullable=True, comment='发布日期'),
    sa.Column('last_updated_date', sa.DateTime(), nullable=True, comment='最后更新日期'),
    sa.Column('notes', sa.Text(), nullable=True, comment='内部备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['category_id'], ['file_category.id'], ),
    sa.ForeignKeyConstraint(['file_media_id'], ['media_file.id'], ),
    sa.ForeignKeyConstraint(['previous_version_id'], ['file_download.id'], ),
    sa.ForeignKeyConstraint(['thumbnail_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('gallery',
    sa.Column('title', sa.String(length=200), nullable=False, comment='画廊标题'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='画廊Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='画廊描述'),
    sa.Column('category', sa.String(length=100), nullable=True, comment='画廊分类'),
    sa.Column('tags', sa.String(length=255), nullable=True, comment='标签(逗号分隔)'),
    sa.Column('cover_media_id', sa.Integer(), nullable=True, comment='封面图片ID'),
    sa.Column('display_mode', sa.String(length=50), nullable=True, comment='展示模式(grid=网格,masonry=瀑布流,slider=轮播)'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('is_public', sa.Boolean(), nullable=False, comment='是否公开'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('allow_download', sa.Boolean(), nullable=False, comment='是否允许下载图片'),
    sa.Column('watermark_enabled', sa.Boolean(), nullable=False, comment='是否启用水印'),
    sa.Column('seo_title', sa.String(length=200), nullable=True, comment='SEO标题'),
    sa.Column('seo_description', sa.Text(), nullable=True, comment='SEO描述'),
    sa.Column('view_count', sa.Integer(), nullable=False, comment='浏览次数'),
    sa.Column('image_count', sa.Integer(), nullable=False, comment='图片数量'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['cover_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('menu_category',
    sa.Column('name', sa.String(length=100), nullable=False, comment='分类名称'),
    sa.Column('slug', sa.String(length=100), nullable=False, comment='分类Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='分类描述'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_active', sa.Boolean(), nullable=False, comment='是否启用'),
    sa.Column('available_times', sa.String(length=255), nullable=True, comment='可用时段(如:breakfast,lunch,dinner)'),
    sa.Column('image_media_id', sa.Integer(), nullable=True, comment='分类图片ID'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['image_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('order',
    sa.Column('order_number', sa.String(length=50), nullable=False, comment='订单号(唯一标识)'),
    sa.Column('user_id', sa.Integer(), nullable=True, comment='关联用户ID(可选,支持游客)'),
    sa.Column('status', sa.Enum('pending', 'confirmed', 'processing', 'shipped', 'delivered', 'cancelled', 'refunded', name='order_status'), nullable=False, comment='订单状态'),
    sa.Column('payment_status', sa.Enum('unpaid', 'paid', 'partial', 'refunded', name='payment_status'), nullable=False, comment='支付状态'),
    sa.Column('customer_email', sa.String(length=100), nullable=False, comment='客户邮箱'),
    sa.Column('customer_phone', sa.String(length=50), nullable=True, comment='客户电话'),
    sa.Column('customer_name', sa.String(length=100), nullable=False, comment='客户姓名'),
    sa.Column('shipping_address_line1', sa.String(length=255), nullable=False, comment='配送地址行1'),
    sa.Column('shipping_address_line2', sa.String(length=255), nullable=True, comment='配送地址行2'),
    sa.Column('shipping_city', sa.String(length=100), nullable=False, comment='配送城市'),
    sa.Column('shipping_state', sa.String(length=100), nullable=True, comment='配送州/省'),
    sa.Column('shipping_postal_code', sa.String(length=20), nullable=False, comment='配送邮编'),
    sa.Column('shipping_country', sa.String(length=100), nullable=False, comment='配送国家'),
    sa.Column('billing_address_line1', sa.String(length=255), nullable=True, comment='账单地址行1'),
    sa.Column('billing_address_line2', sa.String(length=255), nullable=True, comment='账单地址行2'),
    sa.Column('billing_city', sa.String(length=100), nullable=True, comment='账单城市'),
    sa.Column('billing_state', sa.String(length=100), nullable=True, comment='账单州/省'),
    sa.Column('billing_postal_code', sa.String(length=20), nullable=True, comment='账单邮编'),
    sa.Column('billing_country', sa.String(length=100), nullable=True, comment='账单国家'),
    sa.Column('billing_same_as_shipping', sa.Boolean(), nullable=False, comment='账单地址是否与配送地址相同'),
    sa.Column('subtotal', sa.Float(), nullable=False, comment='商品小计'),
    sa.Column('shipping_fee', sa.Float(), nullable=False, comment='运费'),
    sa.Column('tax_amount', sa.Float(), nullable=False, comment='税费'),
    sa.Column('discount_amount', sa.Float(), nullable=False, comment='折扣金额'),
    sa.Column('total_amount', sa.Float(), nullable=False, comment='订单总额'),
    sa.Column('paid_amount', sa.Float(), nullable=False, comment='已支付金额'),
    sa.Column('coupon_code', sa.String(length=50), nullable=True, comment='优惠码'),
    sa.Column('coupon_discount', sa.Float(), nullable=False, comment='优惠码折扣金额'),
    sa.Column('shipping_method', sa.Enum('standard', 'express', 'pickup', name='shipping_method'), nullable=False, comment='配送方式'),
    sa.Column('shipping_carrier', sa.String(length=100), nullable=True, comment='物流公司'),
    sa.Column('tracking_number', sa.String(length=100), nullable=True, comment='物流追踪号'),
    sa.Column('tracking_url', sa.String(length=255), nullable=True, comment='物流追踪链接'),
    sa.Column('payment_method', sa.Enum('credit_card', 'paypal', 'bank_transfer', 'cash', name='payment_method'), nullable=True, comment='支付方式'),
    sa.Column('payment_transaction_id', sa.String(length=100), nullable=True, comment='支付交易ID'),
    sa.Column('paid_at', sa.DateTime(), nullable=True, comment='支付时间'),
    sa.Column('confirmed_at', sa.DateTime(), nullable=True, comment='确认时间'),
    sa.Column('shipped_at', sa.DateTime(), nullable=True, comment='发货时间'),
    sa.Column('delivered_at', sa.DateTime(), nullable=True, comment='送达时间'),
    sa.Column('cancelled_at', sa.DateTime(), nullable=True, comment='取消时间'),
    sa.Column('customer_notes', sa.Text(), nullable=True, comment='客户备注'),
    sa.Column('admin_notes', sa.Text(), nullable=True, comment='管理员备注'),
    sa.Column('cancel_reason', sa.Text(), nullable=True, comment='取消原因'),
    sa.Column('refund_reason', sa.Text(), nullable=True, comment='退款原因'),
    sa.Column('ip_address', sa.String(length=50), nullable=True, comment='下单IP地址'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('order_number')
    )
    op.create_table('portfolio',
    sa.Column('title', sa.String(length=200), nullable=False, comment='案例标题'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='案例Slug'),
    sa.Column('subtitle', sa.String(length=300), nullable=True, comment='副标题'),
    sa.Column('cover_media_id', sa.Integer(), nullable=True, comment='封面图ID'),
    sa.Column('summary', sa.Text(), nullable=True, comment='案例摘要'),
    sa.Column('background', sa.Text(), nullable=True, comment='项目背景'),
    sa.Column('challenge', sa.Text(), nullable=True, comment='面临挑战'),
    sa.Column('solution', sa.Text(), nullable=True, comment='解决方案'),
    sa.Column('result', sa.Text(), nullable=True, comment='项目成果'),
    sa.Column('content_html', sa.Text(), nullable=True, comment='详细内容HTML'),
    sa.Column('client_name', sa.String(length=200), nullable=True, comment='客户名称'),
    sa.Column('client_logo_media_id', sa.Integer(), nullable=True, comment='客户Logo ID'),
    sa.Column('is_client_anonymous', sa.Boolean(), nullable=False, comment='客户是否匿名'),
    sa.Column('project_date', sa.Date(), nullable=True, comment='项目日期'),
    sa.Column('project_duration', sa.String(length=100), nullable=True, comment='项目时长'),
    sa.Column('project_url', sa.String(length=500), nullable=True, comment='项目链接'),
    sa.Column('tags', sa.String(length=500), nullable=True, comment='标签（逗号分隔）'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('status', sa.Enum('draft', 'published', 'archived', name='portfolio_status'), nullable=False, comment='状态'),
    sa.Column('seo_title', sa.String(length=200), nullable=True, comment='SEO标题'),
    sa.Column('seo_description', sa.Text(), nullable=True, comment='SEO描述'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['client_logo_media_id'], ['media_file.id'], ),
    sa.ForeignKeyConstraint(['cover_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('slug')
    )
    op.create_table('post',
    sa.Column('column_id', sa.Integer(), nullable=False, comment='关联栏目ID'),
    sa.Column('title', sa.String(length=200), nullable=False, comment='文章标题'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='文章Slug'),
    sa.Column('summary', sa.Text(), nullable=True, comment='文章摘要'),
    sa.Column('cover_media_id', sa.Integer(), nullable=True, comment='封面图ID'),
    sa.Column('content_html', sa.Text(), nullable=False, comment='文章内容HTML'),
    sa.Column('is_recommended', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('status', sa.Enum('draft', 'published', 'offline', name='post_status'), nullable=False, comment='状态'),
    sa.Column('seo_title', sa.String(length=200), nullable=True, comment='SEO标题'),
    sa.Column('seo_description', sa.Text(), nullable=True, comment='SEO描述'),
    sa.Column('published_at', sa.DateTime(), nullable=True, comment='发布时间'),
    sa.Column('is_approved', sa.Integer(), nullable=False, comment='是否已审核通过(0=待审核,1=已通过)'),
    sa.Column('admin_reply', sa.Text(), nullable=True, comment='管理员回复内容'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['column_id'], ['site_column.id'], ),
    sa.ForeignKeyConstraint(['cover_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('post_category',
    sa.Column('column_id', sa.Integer(), nullable=False, comment='关联栏目ID'),
    sa.Column('parent_id', sa.Integer(), nullable=True, comment='父分类ID'),
    sa.Column('name', sa.String(length=100), nullable=False, comment='分类名称'),
    sa.Column('slug', sa.String(length=100), nullable=False, comment='分类Slug'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_visible', sa.Boolean(), nullable=False, comment='是否可见'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['column_id'], ['site_column.id'], ),
    sa.ForeignKeyConstraint(['parent_id'], ['post_category.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('product',
    sa.Column('column_id', sa.Integer(), nullable=False, comment='关联栏目ID'),
    sa.Column('name', sa.String(length=200), nullable=False, comment='产品名称'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='产品Slug'),
    sa.Column('summary', sa.Text(), nullable=True, comment='产品卖点/简述'),
    sa.Column('description_html', sa.Text(), nullable=False, comment='详细说明HTML'),
    sa.Column('cover_media_id', sa.Integer(), nullable=True, comment='封面图ID'),
    sa.Column('price_text', sa.String(length=100), nullable=True, comment='价格文本'),
    sa.Column('availability_status', sa.Enum('in_stock', 'out_of_stock', 'inquiry', name='product_availability'), nullable=False, comment='供货状态'),
    sa.Column('is_recommended', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('status', sa.Enum('draft', 'online', 'offline', name='product_status'), nullable=False, comment='状态'),
    sa.Column('seo_title', sa.String(length=200), nullable=True, comment='SEO标题'),
    sa.Column('seo_description', sa.Text(), nullable=True, comment='SEO描述'),
    sa.Column('published_at', sa.DateTime(), nullable=True, comment='上线时间'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['column_id'], ['site_column.id'], ),
    sa.ForeignKeyConstraint(['cover_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('product_category',
    sa.Column('column_id', sa.Integer(), nullable=False, comment='关联栏目ID'),
    sa.Column('parent_id', sa.Integer(), nullable=True, comment='父分类ID'),
    sa.Column('name', sa.String(length=100), nullable=False, comment='分类名称'),
    sa.Column('slug', sa.String(length=100), nullable=False, comment='分类Slug'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_visible', sa.Boolean(), nullable=False, comment='是否可见'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['column_id'], ['site_column.id'], ),
    sa.ForeignKeyConstraint(['parent_id'], ['product_category.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('restaurant_order',
    sa.Column('order_number', sa.String(length=50), nullable=False, comment='订单号(唯一标识)'),
    sa.Column('user_id', sa.Integer(), nullable=True, comment='关联用户ID(可选)'),
    sa.Column('order_type', sa.Enum('dine_in', 'takeaway', 'delivery', name='restaurant_order_type'), nullable=False, comment='订单类型'),
    sa.Column('status', sa.Enum('pending', 'confirmed', 'preparing', 'ready', 'delivering', 'completed', 'cancelled', name='restaurant_order_status'), nullable=False, comment='订单状态'),
    sa.Column('payment_status', sa.Enum('unpaid', 'paid', 'refunded', name='restaurant_payment_status'), nullable=False, comment='支付状态'),
    sa.Column('customer_name', sa.String(length=100), nullable=False, comment='客户姓名'),
    sa.Column('customer_phone', sa.String(length=50), nullable=False, comment='客户电话'),
    sa.Column('customer_email', sa.String(length=100), nullable=True, comment='客户邮箱'),
    sa.Column('table_number', sa.String(length=20), nullable=True, comment='桌号(堂食)'),
    sa.Column('number_of_guests', sa.Integer(), nullable=True, comment='就餐人数(堂食)'),
    sa.Column('delivery_address', sa.String(length=500), nullable=True, comment='配送地址(外卖)'),
    sa.Column('delivery_city', sa.String(length=100), nullable=True, comment='配送城市'),
    sa.Column('delivery_postal_code', sa.String(length=20), nullable=True, comment='配送邮编'),
    sa.Column('delivery_instructions', sa.Text(), nullable=True, comment='配送说明'),
    sa.Column('pickup_time', sa.DateTime(), nullable=True, comment='取餐时间(自取)'),
    sa.Column('scheduled_time', sa.DateTime(), nullable=True, comment='预定时间(堂食预订)'),
    sa.Column('subtotal', sa.Float(), nullable=False, comment='菜品小计'),
    sa.Column('delivery_fee', sa.Float(), nullable=False, comment='配送费'),
    sa.Column('service_fee', sa.Float(), nullable=False, comment='服务费'),
    sa.Column('tax_amount', sa.Float(), nullable=False, comment='税费'),
    sa.Column('discount_amount', sa.Float(), nullable=False, comment='折扣金额'),
    sa.Column('tip_amount', sa.Float(), nullable=False, comment='小费'),
    sa.Column('total_amount', sa.Float(), nullable=False, comment='订单总额'),
    sa.Column('coupon_code', sa.String(length=50), nullable=True, comment='优惠码'),
    sa.Column('payment_method', sa.Enum('cash', 'card', 'online', name='restaurant_payment_method'), nullable=True, comment='支付方式'),
    sa.Column('paid_at', sa.DateTime(), nullable=True, comment='支付时间'),
    sa.Column('confirmed_at', sa.DateTime(), nullable=True, comment='确认时间'),
    sa.Column('preparing_at', sa.DateTime(), nullable=True, comment='开始准备时间'),
    sa.Column('ready_at', sa.DateTime(), nullable=True, comment='准备完成时间'),
    sa.Column('delivered_at', sa.DateTime(), nullable=True, comment='送达时间'),
    sa.Column('completed_at', sa.DateTime(), nullable=True, comment='完成时间'),
    sa.Column('cancelled_at', sa.DateTime(), nullable=True, comment='取消时间'),
    sa.Column('customer_notes', sa.Text(), nullable=True, comment='客户备注'),
    sa.Column('kitchen_notes', sa.Text(), nullable=True, comment='厨房备注'),
    sa.Column('cancel_reason', sa.Text(), nullable=True, comment='取消原因'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('order_number')
    )
    op.create_table('single_page',
    sa.Column('column_id', sa.Integer(), nullable=False, comment='关联栏目ID'),
    sa.Column('title', sa.String(length=200), nullable=False, comment='页面标题'),
    sa.Column('subtitle', sa.String(length=300), nullable=True, comment='副标题'),
    sa.Column('content_html', sa.Text(), nullable=False, comment='页面内容HTML'),
    sa.Column('hero_media_id', sa.Integer(), nullable=True, comment='主图/背景图ID'),
    sa.Column('seo_title', sa.String(length=200), nullable=True, comment='SEO标题'),
    sa.Column('seo_description', sa.Text(), nullable=True, comment='SEO描述'),
    sa.Column('status', sa.Enum('draft', 'published', 'hidden', name='single_page_status'), nullable=False, comment='状态'),
    sa.Column('published_at', sa.DateTime(), nullable=True, comment='发布时间'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['column_id'], ['site_column.id'], ),
    sa.ForeignKeyConstraint(['hero_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('column_id')
    )
    op.create_table('team_member',
    sa.Column('name', sa.String(length=100), nullable=False, comment='姓名'),
    sa.Column('title', sa.String(length=100), nullable=True, comment='职位/头衔'),
    sa.Column('department', sa.String(length=100), nullable=True, comment='部门/团队'),
    sa.Column('photo_media_id', sa.Integer(), nullable=True, comment='照片ID'),
    sa.Column('bio', sa.Text(), nullable=True, comment='个人简介'),
    sa.Column('qualifications', sa.Text(), nullable=True, comment='专业资质与证书'),
    sa.Column('specialties', sa.String(length=500), nullable=True, comment='专长领域'),
    sa.Column('email', sa.String(length=100), nullable=True, comment='邮箱'),
    sa.Column('phone', sa.String(length=50), nullable=True, comment='电话'),
    sa.Column('linkedin', sa.String(length=255), nullable=True, comment='LinkedIn链接'),
    sa.Column('twitter', sa.String(length=255), nullable=True, comment='Twitter链接'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否为核心成员'),
    sa.Column('is_active', sa.Boolean(), nullable=False, comment='是否启用'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['photo_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('video',
    sa.Column('title', sa.String(length=200), nullable=False, comment='视频标题'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='视频Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='视频描述'),
    sa.Column('category_id', sa.Integer(), nullable=True, comment='视频分类ID'),
    sa.Column('video_source', sa.Enum('upload', 'youtube', 'vimeo', 'external', name='video_source'), nullable=False, comment='视频来源'),
    sa.Column('video_media_id', sa.Integer(), nullable=True, comment='上传视频文件ID'),
    sa.Column('youtube_id', sa.String(length=100), nullable=True, comment='YouTube视频ID'),
    sa.Column('vimeo_id', sa.String(length=100), nullable=True, comment='Vimeo视频ID'),
    sa.Column('external_url', sa.String(length=500), nullable=True, comment='外部视频链接'),
    sa.Column('thumbnail_media_id', sa.Integer(), nullable=True, comment='缩略图ID'),
    sa.Column('duration_seconds', sa.Integer(), nullable=True, comment='视频时长(秒)'),
    sa.Column('resolution', sa.String(length=20), nullable=True, comment='分辨率(如:1920x1080)'),
    sa.Column('file_size_mb', sa.Integer(), nullable=True, comment='文件大小(MB)'),
    sa.Column('autoplay', sa.Boolean(), nullable=False, comment='是否自动播放'),
    sa.Column('loop', sa.Boolean(), nullable=False, comment='是否循环播放'),
    sa.Column('muted', sa.Boolean(), nullable=False, comment='是否静音'),
    sa.Column('controls', sa.Boolean(), nullable=False, comment='是否显示控制条'),
    sa.Column('has_subtitles', sa.Boolean(), nullable=False, comment='是否有字幕'),
    sa.Column('subtitle_url', sa.String(length=500), nullable=True, comment='字幕文件URL'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('is_public', sa.Boolean(), nullable=False, comment='是否公开'),
    sa.Column('status', sa.Enum('draft', 'published', 'archived', name='video_status'), nullable=False, comment='视频状态'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('tags', sa.String(length=255), nullable=True, comment='标签(逗号分隔)'),
    sa.Column('view_count', sa.Integer(), nullable=False, comment='播放次数'),
    sa.Column('like_count', sa.Integer(), nullable=False, comment='点赞数'),
    sa.Column('share_count', sa.Integer(), nullable=False, comment='分享数'),
    sa.Column('seo_title', sa.String(length=200), nullable=True, comment='SEO标题'),
    sa.Column('seo_description', sa.Text(), nullable=True, comment='SEO描述'),
    sa.Column('embed_code', sa.Text(), nullable=True, comment='嵌入代码'),
    sa.Column('allow_embed', sa.Boolean(), nullable=False, comment='是否允许嵌入'),
    sa.Column('requires_login', sa.Boolean(), nullable=False, comment='是否需要登录观看'),
    sa.Column('allowed_roles', sa.String(length=255), nullable=True, comment='允许观看的角色(逗号分隔)'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('published_at', sa.String(length=200), nullable=True, comment='发布时间'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['category_id'], ['video_category.id'], ),
    sa.ForeignKeyConstraint(['thumbnail_media_id'], ['media_file.id'], ),
    sa.ForeignKeyConstraint(['video_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('video_playlist',
    sa.Column('title', sa.String(length=200), nullable=False, comment='播放列表标题'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='播放列表Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='播放列表描述'),
    sa.Column('cover_media_id', sa.Integer(), nullable=True, comment='封面图片ID'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('is_public', sa.Boolean(), nullable=False, comment='是否公开'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('video_count', sa.Integer(), nullable=False, comment='视频数量'),
    sa.Column('total_duration_seconds', sa.Integer(), nullable=False, comment='总时长(秒)'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['cover_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('booking',
    sa.Column('user_id', sa.Integer(), nullable=True, comment='关联用户ID(可选)'),
    sa.Column('service_id', sa.Integer(), nullable=False, comment='预约服务ID'),
    sa.Column('staff_id', sa.Integer(), nullable=True, comment='指定服务人员ID'),
    sa.Column('booking_number', sa.String(length=50), nullable=False, comment='预约编号(唯一标识)'),
    sa.Column('booking_date', sa.DateTime(), nullable=False, comment='预约日期时间'),
    sa.Column('duration_minutes', sa.Integer(), nullable=False, comment='预约时长(分钟)'),
    sa.Column('end_datetime', sa.DateTime(), nullable=True, comment='预约结束时间'),
    sa.Column('customer_name', sa.String(length=100), nullable=False, comment='客户姓名'),
    sa.Column('customer_email', sa.String(length=100), nullable=False, comment='客户邮箱'),
    sa.Column('customer_phone', sa.String(length=50), nullable=False, comment='客户电话'),
    sa.Column('status', sa.Enum('pending', 'confirmed', 'cancelled', 'completed', 'no_show', 'waitlist', name='booking_status'), nullable=False, comment='预约状态'),
    sa.Column('confirmation_method', sa.Enum('auto', 'manual', name='confirmation_method'), nullable=False, comment='确认方式'),
    sa.Column('price', sa.Float(), nullable=True, comment='预约价格'),
    sa.Column('payment_status', sa.Enum('unpaid', 'paid', 'refunded', name='booking_payment_status'), nullable=False, comment='支付状态'),
    sa.Column('payment_method', sa.String(length=50), nullable=True, comment='支付方式'),
    sa.Column('paid_at', sa.DateTime(), nullable=True, comment='支付时间'),
    sa.Column('confirmed_at', sa.DateTime(), nullable=True, comment='确认时间'),
    sa.Column('cancelled_at', sa.DateTime(), nullable=True, comment='取消时间'),
    sa.Column('completed_at', sa.DateTime(), nullable=True, comment='完成时间'),
    sa.Column('reminder_sent_at', sa.DateTime(), nullable=True, comment='提醒发送时间'),
    sa.Column('reminder_count', sa.Integer(), nullable=False, comment='已发送提醒次数'),
    sa.Column('customer_notes', sa.Text(), nullable=True, comment='客户备注'),
    sa.Column('admin_notes', sa.Text(), nullable=True, comment='管理员备注'),
    sa.Column('cancel_reason', sa.Text(), nullable=True, comment='取消原因'),
    sa.Column('source', sa.String(length=50), nullable=True, comment='预约来源(web/phone/app等)'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['service_id'], ['booking_service.id'], ),
    sa.ForeignKeyConstraint(['staff_id'], ['team_member.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('booking_number')
    )
    op.create_table('booking_time_slot',
    sa.Column('service_id', sa.Integer(), nullable=False, comment='服务ID'),
    sa.Column('staff_id', sa.Integer(), nullable=True, comment='服务人员ID'),
    sa.Column('date', sa.DateTime(), nullable=False, comment='日期'),
    sa.Column('start_time', sa.Time(), nullable=False, comment='开始时间'),
    sa.Column('end_time', sa.Time(), nullable=False, comment='结束时间'),
    sa.Column('is_available', sa.Boolean(), nullable=False, comment='是否可预约'),
    sa.Column('available_slots', sa.Integer(), nullable=False, comment='可用名额'),
    sa.Column('booked_slots', sa.Integer(), nullable=False, comment='已预约名额'),
    sa.Column('is_special', sa.Boolean(), nullable=False, comment='是否为特殊时段'),
    sa.Column('special_price', sa.Float(), nullable=True, comment='特殊价格'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['service_id'], ['booking_service.id'], ),
    sa.ForeignKeyConstraint(['staff_id'], ['team_member.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('cart',
    sa.Column('user_id', sa.Integer(), nullable=True, comment='关联用户ID(已登录用户)'),
    sa.Column('session_id', sa.String(length=100), nullable=True, comment='会话ID(访客用户标识)'),
    sa.Column('is_active', sa.Integer(), nullable=False, comment='是否活跃(0=已转换为订单,1=活跃)'),
    sa.Column('converted_to_order_id', sa.Integer(), nullable=True, comment='转换为的订单ID'),
    sa.Column('subtotal', sa.Float(), nullable=False, comment='商品小计'),
    sa.Column('estimated_tax', sa.Float(), nullable=False, comment='预估税费'),
    sa.Column('estimated_shipping', sa.Float(), nullable=False, comment='预估运费'),
    sa.Column('estimated_total', sa.Float(), nullable=False, comment='预估总额'),
    sa.Column('coupon_code', sa.String(length=50), nullable=True, comment='应用的优惠码'),
    sa.Column('discount_amount', sa.Float(), nullable=False, comment='折扣金额'),
    sa.Column('last_activity_at', sa.DateTime(), nullable=True, comment='最后活动时间'),
    sa.Column('expires_at', sa.DateTime(), nullable=True, comment='过期时间(访客购物车)'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['converted_to_order_id'], ['order.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('contact_message',
    sa.Column('name', sa.String(length=100), nullable=False, comment='访客姓名'),
    sa.Column('contact_info', sa.String(length=200), nullable=False, comment='联系方式'),
    sa.Column('message_text', sa.Text(), nullable=False, comment='留言内容'),
    sa.Column('product_id', sa.Integer(), nullable=True, comment='关联产品ID'),
    sa.Column('source_page_url', sa.String(length=500), nullable=True, comment='来源页面URL'),
    sa.Column('status', sa.Enum('unread', 'handled', name='contact_message_status'), nullable=False, comment='处理状态'),
    sa.Column('handled_at', sa.DateTime(), nullable=True, comment='处理时间'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['product_id'], ['product.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('custom_field_option',
    sa.Column('field_id', sa.Integer(), nullable=False, comment='关联字段ID'),
    sa.Column('value', sa.String(length=100), nullable=False, comment='内部存储值'),
    sa.Column('label', sa.String(length=100), nullable=False, comment='显示标签'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_active', sa.Boolean(), nullable=False, comment='是否有效'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['field_id'], ['custom_field_def.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('event_registration',
    sa.Column('event_id', sa.Integer(), nullable=False, comment='活动ID'),
    sa.Column('user_id', sa.Integer(), nullable=True, comment='关联用户ID(可选)'),
    sa.Column('registration_number', sa.String(length=50), nullable=False, comment='报名编号(唯一标识)'),
    sa.Column('attendee_name', sa.String(length=100), nullable=False, comment='参会者姓名'),
    sa.Column('attendee_email', sa.String(length=100), nullable=False, comment='参会者邮箱'),
    sa.Column('attendee_phone', sa.String(length=50), nullable=True, comment='参会者电话'),
    sa.Column('company', sa.String(length=200), nullable=True, comment='所属公司/机构'),
    sa.Column('job_title', sa.String(length=100), nullable=True, comment='职位'),
    sa.Column('status', sa.Enum('pending', 'confirmed', 'waitlist', 'cancelled', 'attended', 'no_show', name='registration_status'), nullable=False, comment='报名状态'),
    sa.Column('ticket_type', sa.Enum('regular', 'early_bird', 'vip', 'free', name='ticket_type'), nullable=False, comment='票务类型'),
    sa.Column('ticket_price', sa.Float(), nullable=False, comment='票价'),
    sa.Column('payment_status', sa.Enum('unpaid', 'paid', 'refunded', name='event_payment_status'), nullable=False, comment='支付状态'),
    sa.Column('payment_method', sa.String(length=50), nullable=True, comment='支付方式'),
    sa.Column('payment_transaction_id', sa.String(length=100), nullable=True, comment='支付交易ID'),
    sa.Column('paid_at', sa.DateTime(), nullable=True, comment='支付时间'),
    sa.Column('registered_at', sa.DateTime(), nullable=True, comment='报名时间'),
    sa.Column('confirmed_at', sa.DateTime(), nullable=True, comment='确认时间'),
    sa.Column('checked_in_at', sa.DateTime(), nullable=True, comment='签到时间'),
    sa.Column('cancelled_at', sa.DateTime(), nullable=True, comment='取消时间'),
    sa.Column('check_in_code', sa.String(length=100), nullable=True, comment='签到码(二维码)'),
    sa.Column('is_checked_in', sa.Boolean(), nullable=False, comment='是否已签到'),
    sa.Column('check_in_method', sa.String(length=50), nullable=True, comment='签到方式(qr_code/manual等)'),
    sa.Column('dietary_requirements', sa.Text(), nullable=True, comment='饮食要求'),
    sa.Column('special_needs', sa.Text(), nullable=True, comment='特殊需求'),
    sa.Column('how_heard', sa.String(length=100), nullable=True, comment='如何得知活动'),
    sa.Column('custom_fields', sa.Text(), nullable=True, comment='自定义字段(JSON格式)'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('admin_notes', sa.Text(), nullable=True, comment='管理员备注'),
    sa.Column('cancel_reason', sa.Text(), nullable=True, comment='取消原因'),
    sa.Column('confirmation_email_sent', sa.Boolean(), nullable=False, comment='是否已发送确认邮件'),
    sa.Column('reminder_email_sent', sa.Boolean(), nullable=False, comment='是否已发送提醒邮件'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['event_id'], ['event.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('registration_number')
    )
    op.create_table('event_ticket_type',
    sa.Column('event_id', sa.Integer(), nullable=False, comment='活动ID'),
    sa.Column('name', sa.String(length=100), nullable=False, comment='票务名称'),
    sa.Column('description', sa.Text(), nullable=True, comment='票务描述'),
    sa.Column('price', sa.Float(), nullable=False, comment='价格'),
    sa.Column('quantity', sa.Integer(), nullable=True, comment='数量(null表示不限)'),
    sa.Column('sold_count', sa.Integer(), nullable=False, comment='已售数量'),
    sa.Column('sale_start_time', sa.DateTime(), nullable=True, comment='开售时间'),
    sa.Column('sale_end_time', sa.DateTime(), nullable=True, comment='停售时间'),
    sa.Column('is_active', sa.Boolean(), nullable=False, comment='是否启用'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['event_id'], ['event.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('file_download_log',
    sa.Column('file_id', sa.Integer(), nullable=False, comment='文件ID'),
    sa.Column('user_id', sa.Integer(), nullable=True, comment='用户ID(已登录用户)'),
    sa.Column('ip_address', sa.String(length=50), nullable=True, comment='下载IP地址'),
    sa.Column('user_agent', sa.String(length=500), nullable=True, comment='用户代理'),
    sa.Column('referrer', sa.String(length=500), nullable=True, comment='来源页面'),
    sa.Column('download_status', sa.Enum('success', 'failed', 'cancelled', name='download_log_status'), nullable=False, comment='下载状态'),
    sa.Column('error_message', sa.Text(), nullable=True, comment='错误信息(如果失败)'),
    sa.Column('downloaded_at', sa.DateTime(), nullable=True, comment='下载时间'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['file_id'], ['file_download.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('gallery_image',
    sa.Column('gallery_id', sa.Integer(), nullable=False, comment='画廊ID'),
    sa.Column('media_id', sa.Integer(), nullable=False, comment='图片文件ID'),
    sa.Column('title', sa.String(length=200), nullable=True, comment='图片标题'),
    sa.Column('caption', sa.Text(), nullable=True, comment='图片说明'),
    sa.Column('alt_text', sa.String(length=255), nullable=True, comment='图片Alt文本(SEO)'),
    sa.Column('tags', sa.String(length=255), nullable=True, comment='标签(逗号分隔)'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('is_visible', sa.Boolean(), nullable=False, comment='是否可见'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否精选'),
    sa.Column('link_url', sa.String(length=500), nullable=True, comment='点击图片跳转链接'),
    sa.Column('link_target', sa.String(length=20), nullable=True, comment='链接打开方式(_self/_blank)'),
    sa.Column('view_count', sa.Integer(), nullable=False, comment='浏览次数'),
    sa.Column('download_count', sa.Integer(), nullable=False, comment='下载次数'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['gallery_id'], ['gallery.id'], ),
    sa.ForeignKeyConstraint(['media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('menu_item',
    sa.Column('category_id', sa.Integer(), nullable=False, comment='菜品分类ID'),
    sa.Column('name', sa.String(length=200), nullable=False, comment='菜品名称'),
    sa.Column('slug', sa.String(length=200), nullable=False, comment='菜品Slug'),
    sa.Column('description', sa.Text(), nullable=True, comment='菜品描述'),
    sa.Column('price', sa.Float(), nullable=False, comment='价格'),
    sa.Column('original_price', sa.Float(), nullable=True, comment='原价(用于显示折扣)'),
    sa.Column('image_media_id', sa.Integer(), nullable=True, comment='菜品图片ID'),
    sa.Column('sizes', sa.String(length=255), nullable=True, comment="规格选项(JSON格式,如:[{'name':'小份','price':10},{'name':'大份','price':15}])"),
    sa.Column('spice_levels', sa.String(length=255), nullable=True, comment='辣度选项(如:不辣,微辣,中辣,特辣)'),
    sa.Column('customizations', sa.Text(), nullable=True, comment='可定制选项(JSON格式,如配料、做法等)'),
    sa.Column('calories', sa.Integer(), nullable=True, comment='卡路里'),
    sa.Column('allergens', sa.String(length=255), nullable=True, comment='过敏原(如:坚果,乳制品,麸质)'),
    sa.Column('dietary_tags', sa.String(length=255), nullable=True, comment='饮食标签(如:素食,无麸质,清真)'),
    sa.Column('is_available', sa.Boolean(), nullable=False, comment='是否可售'),
    sa.Column('stock_quantity', sa.Integer(), nullable=True, comment='库存数量(null表示不限)'),
    sa.Column('daily_limit', sa.Integer(), nullable=True, comment='每日限量'),
    sa.Column('today_sold', sa.Integer(), nullable=False, comment='今日已售'),
    sa.Column('is_recommended', sa.Boolean(), nullable=False, comment='是否推荐'),
    sa.Column('is_popular', sa.Boolean(), nullable=False, comment='是否热门'),
    sa.Column('is_new', sa.Boolean(), nullable=False, comment='是否新品'),
    sa.Column('is_seasonal', sa.Boolean(), nullable=False, comment='是否时令'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['category_id'], ['menu_category.id'], ),
    sa.ForeignKeyConstraint(['image_media_id'], ['media_file.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('order_item',
    sa.Column('order_id', sa.Integer(), nullable=False, comment='订单ID'),
    sa.Column('product_id', sa.Integer(), nullable=True, comment='产品ID(可能已删除)'),
    sa.Column('product_name', sa.String(length=200), nullable=False, comment='产品名称'),
    sa.Column('product_sku', sa.String(length=100), nullable=True, comment='产品SKU'),
    sa.Column('product_variant', sa.String(length=255), nullable=True, comment='产品规格(如:颜色,尺寸)'),
    sa.Column('quantity', sa.Integer(), nullable=False, comment='购买数量'),
    sa.Column('unit_price', sa.Float(), nullable=False, comment='单价'),
    sa.Column('subtotal', sa.Float(), nullable=False, comment='小计(单价×数量)'),
    sa.Column('discount_amount', sa.Float(), nullable=False, comment='折扣金额'),
    sa.Column('total_price', sa.Float(), nullable=False, comment='总价(小计-折扣)'),
    sa.Column('notes', sa.Text(), nullable=True, comment='备注'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['order_id'], ['order.id'], ),
    sa.ForeignKeyConstraint(['product_id'], ['product.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('portfolio_category_link',
    sa.Column('portfolio_id', sa.Integer(), nullable=False, comment='案例ID'),
    sa.Column('category_id', sa.Integer(), nullable=False, comment='分类ID'),
    sa.ForeignKeyConstraint(['category_id'], ['portfolio_category.id'], ),
    sa.ForeignKeyConstraint(['portfolio_id'], ['portfolio.id'], ),
    sa.PrimaryKeyConstraint('portfolio_id', 'category_id')
    )
    op.create_table('portfolio_image',
    sa.Column('portfolio_id', sa.Integer(), nullable=False, comment='关联案例ID'),
    sa.Column('media_id', sa.Integer(), nullable=False, comment='图片ID'),
    sa.Column('caption', sa.String(length=500), nullable=True, comment='图片说明'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='排序序号'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['media_id'], ['media_file.id'], ),
    sa.ForeignKeyConstraint(['portfolio_id'], ['portfolio.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('post_category_link',
    sa.Column('post_id', sa.Integer(), nullable=False, comment='文章ID'),
    sa.Column('category_id', sa.Integer(), nullable=False, comment='分类ID'),
    sa.ForeignKeyConstraint(['category_id'], ['post_category.id'], ),
    sa.ForeignKeyConstraint(['post_id'], ['post.id'], ),
    sa.PrimaryKeyConstraint('post_id', 'category_id')
    )
    op.create_table('product_category_link',
    sa.Column('product_id', sa.Integer(), nullable=False, comment='产品ID'),
    sa.Column('category_id', sa.Integer(), nullable=False, comment='分类ID'),
    sa.ForeignKeyConstraint(['category_id'], ['product_category.id'], ),
    sa.ForeignKeyConstraint(['product_id'], ['product.id'], ),
    sa.PrimaryKeyConstraint('product_id', 'category_id')
    )
    op.create_table('product_custom_field_value',
    sa.Column('product_id', sa.Integer(), nullable=False, comment='产品ID'),
    sa.Column('field_id', sa.Integer(), nullable=False, comment='字段ID'),
    sa.Column('value_text', sa.Text(), nullable=False, comment='字段值'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['field_id'], ['custom_field_def.id'], ),
    sa.ForeignKeyConstraint(['product_id'], ['product.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('review',
    sa.Column('reviewable_type', sa.String(length=50), nullable=False, comment='评价对象类型（product/service等）'),
    sa.Column('reviewable_id', sa.Integer(), nullable=False, comment='评价对象ID'),
    sa.Column('reviewer_name', sa.String(length=100), nullable=False, comment='评价者姓名'),
    sa.Column('reviewer_email', sa.String(length=100), nullable=False, comment='评价者邮箱'),
    sa.Column('reviewer_photo', sa.String(length=500), nullable=True, comment='评价者头像'),
    sa.Column('user_id', sa.Integer(), nullable=True, comment='关联用户ID'),
    sa.Column('title', sa.String(length=200), nullable=True, comment='评价标题'),
    sa.Column('content', sa.Text(), nullable=False, comment='评价内容'),
    sa.Column('overall_rating', sa.Integer(), nullable=False, comment='总体评分（1-5星）'),
    sa.Column('quality_rating', sa.Integer(), nullable=True, comment='质量评分'),
    sa.Column('service_rating', sa.Integer(), nullable=True, comment='服务评分'),
    sa.Column('value_rating', sa.Integer(), nullable=True, comment='性价比评分'),
    sa.Column('is_verified_purchase', sa.Boolean(), nullable=False, comment='是否验证购买'),
    sa.Column('order_id', sa.Integer(), nullable=True, comment='关联订单ID'),
    sa.Column('status', sa.Enum('pending', 'approved', 'rejected', name='review_status'), nullable=False, comment='状态'),
    sa.Column('is_featured', sa.Boolean(), nullable=False, comment='是否精选'),
    sa.Column('helpful_count', sa.Integer(), nullable=False, comment='有用次数'),
    sa.Column('unhelpful_count', sa.Integer(), nullable=False, comment='无用次数'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['order_id'], ['order.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('video_playlist_link',
    sa.Column('playlist_id', sa.Integer(), nullable=False, comment='播放列表ID'),
    sa.Column('video_id', sa.Integer(), nullable=False, comment='视频ID'),
    sa.Column('sort_order', sa.Integer(), nullable=False, comment='在播放列表中的排序'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['playlist_id'], ['video_playlist.id'], ),
    sa.ForeignKeyConstraint(['video_id'], ['video.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('cart_item',
    sa.Column('cart_id', sa.Integer(), nullable=False, comment='购物车ID'),
    sa.Column('product_id', sa.Integer(), nullable=False, comment='产品ID'),
    sa.Column('product_variant', sa.String(length=255), nullable=True, comment='产品规格(如:颜色=红色,尺寸=L)'),
    sa.Column('product_sku', sa.String(length=100), nullable=True, comment='产品SKU'),
    sa.Column('quantity', sa.Integer(), nullable=False, comment='数量'),
    sa.Column('unit_price', sa.Float(), nullable=False, comment='单价(添加时的价格)'),
    sa.Column('subtotal', sa.Float(), nullable=False, comment='小计(单价×数量)'),
    sa.Column('discount_amount', sa.Float(), nullable=False, comment='折扣金额'),
    sa.Column('total_price', sa.Float(), nullable=False, comment='总价(小计-折扣)'),
    sa.Column('notes', sa.Text(), nullable=True, comment='特殊要求备注'),
    sa.Column('added_at', sa.DateTime(), nullable=True, comment='添加到购物车时间'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['cart_id'], ['cart.id'], ),
    sa.ForeignKeyConstraint(['product_id'], ['product.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('restaurant_order_item',
    sa.Column('order_id', sa.Integer(), nullable=False, comment='订单ID'),
    sa.Column('menu_item_id', sa.Integer(), nullable=True, comment='菜品ID(可能已删除)'),
    sa.Column('item_name', sa.String(length=200), nullable=False, comment='菜品名称'),
    sa.Column('item_description', sa.Text(), nullable=True, comment='菜品描述'),
    sa.Column('quantity', sa.Integer(), nullable=False, comment='数量'),
    sa.Column('unit_price', sa.Float(), nullable=False, comment='单价'),
    sa.Column('subtotal', sa.Float(), nullable=False, comment='小计'),
    sa.Column('size_option', sa.String(length=50), nullable=True, comment='规格选择(如:大份)'),
    sa.Column('spice_level', sa.String(length=50), nullable=True, comment='辣度选择'),
    sa.Column('customizations', sa.Text(), nullable=True, comment='定制要求(JSON格式)'),
    sa.Column('special_instructions', sa.Text(), nullable=True, comment='特殊要求'),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('updated_at', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['menu_item_id'], ['menu_item.id'], ),
    sa.ForeignKeyConstraint(['order_id'], ['restaurant_order.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('restaurant_order_item')
    op.drop_table('cart_item')
    op.drop_table('video_playlist_link')
    op.drop_table('review')
    op.drop_table('product_custom_field_value')
    op.drop_table('product_category_link')
    op.drop_table('post_category_link')
    op.drop_table('portfolio_image')
    op.drop_table('portfolio_category_link')
    op.drop_table('order_item')
    op.drop_table('menu_item')
    op.drop_table('gallery_image')
    op.drop_table('file_download_log')
    op.drop_table('event_ticket_type')
    op.drop_table('event_registration')
    op.drop_table('custom_field_option')
    op.drop_table('contact_message')
    op.drop_table('cart')
    op.drop_table('booking_time_slot')
    op.drop_table('booking')
    op.drop_table('video_playlist')
    op.drop_table('video')
    op.drop_table('team_member')
    op.drop_table('single_page')
    op.drop_table('restaurant_order')
    op.drop_table('product_category')
    op.drop_table('product')
    op.drop_table('post_category')
    op.drop_table('post')
    op.drop_table('portfolio')
    op.drop_table('order')
    op.drop_table('menu_category')
    op.drop_table('gallery')
    op.drop_table('file_download')
    op.drop_table('event')
    op.drop_table('custom_field_def')
    op.drop_table('comment')
    op.drop_table('video_category')
    op.drop_table('user')
    op.drop_table('site_setting')
    op.drop_table('site_column')
    op.drop_table('portfolio_category')
    op.drop_table('newsletter_subscriber')
    op.drop_table('newsletter_campaign')
    op.drop_table('media_file')
    op.drop_table('file_category')
    op.drop_table('faq_category')
    op.drop_table('faq')
    op.drop_table('booking_service')
    # ### end Alembic commands ###
